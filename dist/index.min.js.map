{"version":3,"file":"index.min.js","sources":["../src/is.js","../src/operators/assign.js","../src/reactive.jsx","../src/operators/par.js","../src/operators/handle.js","../src/operators/prev.js"],"sourcesContent":["// @flow\nexport function isFunction(o: any): boolean {\n    return typeof o === 'function';\n}\n\nexport function isObject(o: any): boolean {\n    return (\n        Boolean(o) &&\n        typeof o === 'object' &&\n        Object.prototype.toString.call(o) === '[object Object]'\n    );\n}\n\nexport function isNil(o: any): boolean {\n    return o === null || o === undefined;\n}\n\nexport function isSame(objA: any, objB: any): boolean {\n    if (objA === objB) {\n        return true;\n    }\n    if (!isObject(objA) || !isObject(objB)) {\n        return false;\n    }\n    const keysA = Object.keys(objA);\n    const keysB = Object.keys(objB);\n    const sameSize = keysA.length === keysB.length;\n    const sameValues = () => keysA.every(key => objA[key] === objB[key]);\n    return sameSize && sameValues();\n}\n","import { scan } from 'rxjs/operators';\n\nexport function assign() {\n    return scan((acc, delta) => Object.assign({}, acc, delta), {});\n}\n","import React, { Component } from 'react';\nimport { BehaviorSubject, of, concat, combineLatest } from 'rxjs';\nimport { filter, distinctUntilChanged } from 'rxjs/operators';\nimport { assign } from './operators';\nimport { isObject, isSame } from './is';\n\nexport function reactive(propsMapper) {\n    return WrappedComponent =>\n        class ReactiveWrapper extends Component {\n            static displayName = `Reactive(${WrappedComponent.displayName ||\n                WrappedComponent.name})`;\n\n            constructor(props) {\n                super(props);\n                this.state = props;\n            }\n\n            componentDidMount() {\n                this.propsSubject = new BehaviorSubject(this.props);\n                const props$ = this.propsSubject.pipe(distinctUntilChanged(isSame));\n                const deltaProps$ = propsMapper(props$).pipe(\n                    filter(isObject),\n                    assign(),\n                );\n                const newProps$ = combineLatest(\n                    props$,\n                    concat(of({}), deltaProps$),\n                    (props, delta) => Object.assign({}, props, delta),\n                );\n                this.subscription = newProps$.subscribe((newProps) => {\n                    this.setState(newProps);\n                });\n            }\n\n            componentDidUpdate() {\n                this.propsSubject.next(this.props);\n            }\n\n            componentWillUnmount() {\n                this.propsSubject.complete();\n                this.subscription.unsubscribe();\n            }\n\n            render() {\n                return <WrappedComponent {...this.state} />;\n            }\n        };\n}\n","import { merge } from 'rxjs';\n\nexport function par(...operators) {\n    return props$ => merge(...operators.map(op => op(props$)));\n}\n","import { Subject, of, concat } from 'rxjs';\nimport { filter, pluck, distinctUntilChanged, switchMap } from 'rxjs/operators';\nimport { isFunction, isObject } from '../is';\n\nexport function handle(propName, ...handlerOperators) {\n    return props$ =>\n        props$.pipe(\n            pluck(propName),\n            distinctUntilChanged(),\n            switchMap((handler) => {\n                const eventsSubject = new Subject();\n                const wrappedHandler = (event) => {\n                    eventsSubject.next(event);\n                    if (isFunction(handler)) handler(event);\n                };\n                return concat(\n                    of({\n                        [propName]: wrappedHandler,\n                    }),\n                    eventsSubject.pipe(\n                        ...handlerOperators,\n                        filter(obj => !(obj instanceof Event)),\n                        filter(isObject),\n                    ),\n                );\n            }),\n        );\n}\n","import { startWith, pairwise, map } from 'rxjs/operators';\n\nexport function prev(startVal) {\n    return props$ =>\n        props$.pipe(\n            startWith(startVal),\n            pairwise(),\n            map(([previous]) => previous),\n        );\n}\n"],"names":["isFunction","o","isObject","Boolean","Object","prototype","toString","call","isSame","objA","objB","keysA","keys","keysB","length","sameValues","every","key","assign","scan","acc","delta","reactive","propsMapper","props","_Component","state","componentDidMount","propsSubject","BehaviorSubject","this","props$","pipe","distinctUntilChanged","deltaProps$","filter","newProps$","combineLatest","concat","of","subscription","subscribe","newProps","setState","componentDidUpdate","next","componentWillUnmount","complete","unsubscribe","render","React","WrappedComponent","Component","displayName","name","par","operators","merge","map","op","handle","propName","handlerOperators","pluck","switchMap","handler","eventsSubject","Subject","wrappedHandler","event","obj","Event","prev","startVal","startWith","pairwise","isNil"],"mappings":"0iBACO,SAASA,WAAWC,SACH,mBAANA,EAGX,SAASC,SAASD,UAEjBE,QAAQF,IACK,qBAANA,gBAAAA,KAC+B,oBAAtCG,OAAOC,UAAUC,SAASC,KAAKN,GAQhC,SAASO,OAAOC,EAAWC,MAC1BD,IAASC,SACF,MAENR,SAASO,KAAUP,SAASQ,UACtB,MAELC,EAAQP,OAAOQ,KAAKH,GACpBI,EAAQT,OAAOQ,KAAKF,UACTC,EAAMG,SAAWD,EAAMC,QACrB,SAAbC,oBAAmBJ,EAAMK,MAAM,mBAAOP,EAAKQ,KAASP,EAAKO,KAC5CF,YC1BPG,gBACLC,OAAK,SAACC,EAAKC,UAAUjB,OAAOc,OAAO,GAAIE,EAAKC,IAAQ,eCGxD,SAASC,SAASC,UACd,oEAKaC,oSACRC,YAAMD,aACDE,MAAQF,kXAGjBG,+DACSC,aAAe,IAAIC,kBAAgBC,KAAKN,WACvCO,EAASD,KAAKF,aAAaI,KAAKC,uBAAqBzB,SACrD0B,EAAcX,EAAYQ,GAAQC,KACpCG,SAAOjC,UACPgB,UAEEkB,EAAYC,gBACdN,EACAO,SAAOC,KAAG,IAAKL,GACf,SAACV,EAAOH,UAAUjB,OAAOc,OAAO,GAAIM,EAAOH,UAE1CmB,aAAeJ,EAAUK,UAAU,SAACC,KAChCC,SAASD,gCAItBE,sDACShB,aAAaiB,KAAKf,KAAKN,kCAGhCsB,0DACSlB,aAAamB,gBACbP,aAAaQ,yCAGtBC,gCACWC,gBAACC,EAAqBrB,KAAKJ,yBApCZ0B,eACnBC,yBAA0BF,EAAiBE,aAC9CF,EAAiBG,oBCR1B,SAASC,iCAAOC,gDACZ,mBAAUC,qBAASD,EAAUE,IAAI,mBAAMC,EAAG5B,iBCC9C,SAAS6B,OAAOC,8BAAaC,0DACzB,mBACH/B,EAAOC,KACH+B,QAAMF,GACN5B,yBACA+B,YAAU,SAACC,SACDC,EAAgB,IAAIC,iBAKnB7B,SACHC,aACKsB,GANc,SAAjBO,eAAkBC,KACNxB,KAAKwB,GACfrE,WAAWiE,IAAUA,EAAQI,QAMjCH,EAAclC,aACP8B,UACH3B,SAAO,oBAASmC,aAAeC,SAC/BpC,SAAOjC,0CCpBxB,SAASsE,KAAKC,UACV,mBACH1C,EAAOC,KACH0C,YAAUD,GACVE,aACAjB,MAAI,iFLMT,SAASkB,MAAM3E,UACXA,MAAAA"}